<!DOCTYPE html>
<html>
  <head>
    <title>StreamRec</title>

    <!-- Include eel.js - note this file doesn't exist in the 'web' directory -->
    <script type="text/javascript" src="/eel.js"></script>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript">
      window.onload = function() { loadParams(); }
      window.onbeforeunload = function() { saveParams(); }

      async function saveParams() {
        var x = getParams();
        x = await eel.saveParams(x);
      }
      
      async function loadParams() {
        x = await eel.loadParams()();
        setParams(x);
      }
      
      async function reload() {
        x = await saveParams();
        x = await loadParams();
      }

      eel.expose(pasteResult)
      function pasteResult(x) {
        prl(x);
      }

      async function doCreate() {
        x = await saveParams();
        x = await eel.doCreate(selChan.value, selMode.value, txtStart.value, txtEnd.value, txtTitle.value);
      }

      async function doCmd(cmd, p = null) {
        x = await eel.doCmd(cmd, p);
      }

      function resize() {
        txta.style.height = (window.innerHeight - txta.offsetTop - 2 * txta.offsetLeft) + "px"
      }
      
    </script>
  </head>

  <body id="body" style="overflow:hidden;padding-right:8px;background-color: lightgray;" onresize="resize()">
    <style>
      * { font-family:arial;font-size:10pt; }
      .max { width:100%; padding:2px; }
      .btn1 { width:100%; height:30px; font-weight:bold; color:gold; background-color:red; }
      .btn { width:80px; height:26px; margin-bottom:2px; }
      .hide { display:none }
      .sel { width:100%; padding:2px; }
      .img { width:24px; height:24px; margin: auto auto auto auto; display: block; }
      table { border-collapse:separate; border-spacing:3px 3px; }
    </style>
    <table width="100%"><tr>
        <td width="100px">Channel</td>
        <td width="99%"><select id="selChan" class="sel" save="select"></select></td>
        <td width="70px"><image class="img" title="refresh list" onclick="reload()" src="refresh.png" /></td>
      </tr><tr>
        <td>Mode</td>
        <td><select id="selMode" class="sel" save="select"></select></td>
        <td width="70px"><image class="img" title="show/hide console" onclick="doCmd('Console')" src="terminal.png" /></td>
      </tr><tr>
        <td><a href=# onclick="doCmd('Paste')">Start</a></td>
        <td colspan="2"><input type="text" id="txtStart" class="max" save="value" /></td>
      </tr><tr>
        <td>End</td>
        <td colspan="2"><input type="text" id="txtEnd" class="max" save="value" /></td>
      </tr><tr>
        <td>Title</td>
        <td colspan="2"><input type="text" id="txtTitle" class="max" save="value" /></td>
      </tr><tr>
        <td>Dir</td>
        <td colspan="2"><input type="text" id="txtDir" class="max" save="value" /></td>
      </tr><tr>
        <td></td>
        <td colspan="2">
          <button class="btn" onclick="doCreate()">Create</button>
          <button class="btn" onclick="doCmd('CmdFile')">CmdFile</button>
          <button class="btn" onclick="doCmd('PlsFile')">PlsFile</button>
          <button class="btn" onclick="doCmd('PlayList', selChan.value)">PlayList</button>
          <button class="btn" onclick="doCmd('Play', selChan.value)">Play</button>
          <button class="btn" onclick="doCmd('Tasks')">Tasks</button>
        </td>
      </tr></table>
      Info:<br><textarea id="txta" class="max" style="resize:none;height:100px;"></textarea>
  </body>
</html>